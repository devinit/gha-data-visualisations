(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{231:function(e,n,t){e.exports=t(582)},581:function(e,n,t){},582:function(e,n,t){"use strict";t.r(n);t(232),t(240),t(241),t(242),t(243),t(244),t(245),t(246),t(247),t(248),t(249),t(250),t(251),t(252),t(253),t(254),t(255),t(256),t(257),t(258),t(259),t(260),t(261),t(263),t(110),t(264),t(265),t(266),t(267),t(268),t(269),t(270),t(271),t(272),t(273),t(274),t(276),t(277),t(278),t(280),t(281),t(282),t(149),t(284),t(285),t(286),t(287),t(288),t(289),t(290),t(291),t(292),t(293),t(294),t(296),t(297),t(298),t(299),t(300),t(301),t(302),t(303),t(304),t(305),t(306),t(307),t(308),t(309),t(310),t(311),t(313),t(314),t(315),t(316),t(317),t(318),t(319),t(320),t(321),t(322),t(323),t(324),t(325),t(326),t(327),t(328),t(329),t(330),t(331),t(332),t(333),t(334),t(335),t(337),t(338),t(349),t(350),t(351),t(353),t(354),t(355),t(356),t(357),t(358),t(359),t(360),t(361),t(362),t(363),t(364),t(205),t(366),t(367),t(368),t(370),t(371),t(372),t(373),t(206),t(374),t(375),t(376),t(377),t(378),t(379),t(380),t(381),t(382),t(383),t(384),t(386),t(388),t(389),t(390),t(391),t(392),t(393),t(394),t(395),t(396),t(397),t(398),t(399),t(400),t(401),t(403),t(404),t(405),t(406),t(407),t(408),t(409),t(410),t(411),t(412),t(413),t(415),t(418),t(419),t(420),t(421),t(422),t(423),t(424),t(425),t(426),t(428),t(429),t(430),t(431),t(432),t(433),t(434),t(435),t(436),t(437),t(438),t(439),t(160),t(441),t(443),t(450),t(451),t(452),t(453),t(454),t(456),t(457),t(458),t(459),t(460),t(461),t(462),t(463),t(465),t(466),t(467),t(468),t(469),t(470),t(471),t(472),t(473),t(474),t(475),t(476),t(477),t(478),t(479),t(480),t(481),t(482),t(483),t(484),t(485),t(486),t(487),t(488),t(492),t(494),t(496),t(497),t(498),t(499),t(500),t(502),t(503),t(504),t(505),t(506),t(507),t(508),t(509),t(510),t(511),t(512),t(513),t(514),t(515),t(516),t(517),t(518),t(519),t(520),t(521),t(522),t(523),t(524),t(525),t(526),t(527),t(529),t(531),t(532),t(533),t(534),t(535),t(536),t(537),t(538),t(539),t(540),t(541),t(543),t(544),t(547),t(548),t(551),t(552);var r,a=t(4),o=t(80),i=t.n(o),s=t(81),l=t(130),c=t(1),u=t.n(c),d=t(19),f=t.n(d),p=t(225),m=t(230).a.div(r||(r=Object(p.a)(["\n  color: red;\n  font-size: 11px;\n  position: relative;\n  padding: 5px 5px 5px 0px;\n  display: block;\n"]))),b=function(e){var n=Object(c.useState)(""),t=n[0],r=n[1],a=function(n){n?"maxSelectedOptions"===n.type&&r(e.selectErrorMessage):r("")};return u.a.createElement("div",null,u.a.Children.map(e.children,(function(e){return u.a.isValidElement(e)?u.a.cloneElement(e,{onError:a}):e})),t?u.a.createElement(m,{className:"data-selector--wrapper"},t):null)};b.propTypes={selectErrorMessage:f.a.string,children:f.a.node};var g=b,v=t(226),h=t(229),y={control:function(e){return Object.assign({},e,{borderColor:"#ddd",borderRadius:"none",boxShadow:"none",":hover":{borderColor:"#8f1b13"},":active":{borderColor:"#8f1b13"}})},option:function(e){return Object.assign({},e,{fontSize:"14px"})},singleValue:function(e){return Object.assign({},e,{fontSize:"14px"})},multiValue:function(e){return Object.assign({},e,{fontSize:"14px"})},multiValueLabel:function(e,n){return n.data.isCloseable?e:Object.assign({},e,{paddingRight:6})},multiValueRemove:function(e,n){return n.data.isCloseable?e:Object.assign({},e,{display:"none"})},input:function(e){return Object.assign({},e,{fontSize:"14px"})},indicatorsContainer:function(e){return Object.assign({},e,{pointerEvents:"none"})}},w=function(e){var n=e.label,t=e.onError,r=e.maxSelectedOptions,o=e.defaultValue,i=e.singleSelectOptions,s=Object(l.a)(e,["label","onError","maxSelectedOptions","defaultValue","singleSelectOptions"]),u=Object(c.useState)(o),d=u[0],f=u[1];Object(c.useEffect)((function(){s.onChange&&s.onChange(d),t&&t()}),[d]);return Object(a.c)("div",{className:"labelled-data-selector--wrapper"},Object(a.c)("label",null,Object(a.c)("b",null,n)),Object(a.c)(h.a,Object(v.a)({},s,{value:d,onChange:function(e){if(s.isMulti)if(e.length){var n=e.findIndex((function(e){return i.find((function(n){return n.value===e.value}))}));s.isMulti&&e.length>1&&-1!==n?f(0===n?e.slice(1):[e[n]]):r&&e.length>r?t&&t({type:"maxSelectedOptions",message:"Only up to "+r+" selections allowed"}):f(e)}else f(o);else f(e)},css:{marginRight:"10px"},styles:y,isClearable:"undefined"!==s.isClearable?s.isClearable:d.length>1})))};w.propTypes={label:f.a.string,options:f.a.array,maxSelectedOptions:f.a.number,onChange:f.a.func,onError:f.a.func,defaultValue:f.a.array,singleSelectOptions:f.a.array,isMulti:f.a.bool,isClearable:f.a.bool},w.defaultProps={maxSelectedOptions:2,singleSelectOptions:[]};var S=w,x=function(e){var n=e.defaultDonor,t=e.onSelectDonor,r=Object(l.a)(e,["defaultDonor","onSelectDonor"]),a=Object(c.useState)(r.donors),o=a[0],i=a[1],s=Object(c.useState)(r.defaultDataType),d=s[0],f=s[1];Object(c.useEffect)((function(){i(r.donors)}),[r.donors]);return u.a.createElement(g,{selectErrorMessage:r.donorSelectErrorMessage},u.a.createElement(S,{label:"Select up to two donors",options:o.map((function(e){return{value:e,label:e,isCloseable:!0}})),defaultValue:[{value:n,label:n,isCloseable:!0}],isMulti:!0,onChange:t,css:{minWidth:"200px"},classNamePrefix:"donors-select",isClearable:!1}),u.a.createElement(S,{label:"Display data as",options:["Volumes","Proportions","%GNI"].map((function(e){return{value:e,label:e}})),defaultValue:[{value:d,label:d}],value:d,onChange:function(e){f(e?e.value:r.defaultDataType),r.onSelectDataType&&r.onSelectDataType(e?e.value:r.defaultDataType)},css:{minWidth:"150px"},classNamePrefix:"donors-display-data-as"}))};x.propTypes={donors:f.a.array,donorSelectErrorMessage:f.a.string,onSelectDonor:f.a.func,onSelectDataType:f.a.func,defaultDonor:f.a.string,defaultDataType:f.a.string};var C=x,A=t(227),D=function(e){return new Promise((function(n){Object(A.parse)(e,{download:!0,header:!0,skipEmptyLines:!0,complete:function(e){var t=e.data;return n(t)}})}))},O=function(e){var n,t=document.createElement("div");return(n=t.classList).add.apply(n,["spotlight-banner","data-selector--wrapper"]),e.parentElement.insertBefore(t,e),t},E={rainbow:["#e84439","#eb642b","#f49b21","#109e68","#0089cc","#893f90","#c2135b","#f8c1b2","#f6bb9d","#fccc8e","#92cba9","#88bae5","#c189bb","#e4819b"],default:["#6c120a","#a21e25","#cd2b2a","#dc372d","#ec6250","#f6b0a0","#fbd7cb","#fce3dc"],sunflower:["#7d4712","#ba6b15","#df8000","#f7a838","#fac47e","#fedcab","#fee7c1","#feedd4"],marigold:["#7a2e05","#ac4622","#cb5730","#ee7644","#f4a57c","#facbad","#fcdbbf","#fde5d4"],rose:["#65093d","#8d0e56","#9f1459","#d12568","#e05c86","#f3a5b6","#f6b8c1","#f9cdd0"],lavendar:["#42184c","#632572","#732c85","#994d98","#af73ae","#cb98c4","#deb5d6","#ebcfe5"],bluebell:["#0c457b","#0071b1","#0089cc","#5da3d9","#77adde","#88bae5","#bcd4f0","#d3e0f4"],leaf:["#08492f","#005b3e","#00694a","#3b8c62","#74bf93","#a2d1b0","#b1d8bb","#c5e1cb"],orange:["#973915","#d85b31","#eb642b","#f18e5e","#f4a57c","#f6bb9d"]},_=function(e,n){var t=n.selected,r=Object.values(t).filter((function(e){return e})).length;e.setOption({animation:!0}),0===r?Object.keys(t).forEach((function(n){e.dispatchAction({type:"legendSelect",name:n})})):t[n.name]||(e.dispatchAction({type:"legendSelect",name:n.name}),Object.keys(t).forEach((function(r){Object.prototype.hasOwnProperty.call(t,r)&&r!==n.name&&e.dispatchAction({type:"legendUnSelect",name:r})})))},j={color:E.default.concat(E.rainbow),legend:{left:"10%",top:10,textStyle:{fontFamily:"Geomanist Regular,sans-serif"}},tooltip:{show:!0,trigger:"item",showContent:!0,textStyle:{fontFamily:"Geomanist Regular,sans-serif"}},toolbox:{show:!0,showTitle:!1,feature:{saveAsImage:{title:"Save as PNG",pixelRatio:2}},right:20,tooltip:{show:!0,formatter:function(e){return"<div>"+e.title+"</div>"},textStyle:{fontFamily:"Geomanist Regular,sans-serif"}}},xAxis:{axisLabel:{fontFamily:"Geomanist Regular,sans-serif",fontSize:13},splitLine:{show:!1}},yAxis:{axisLabel:{fontFamily:"Geomanist Regular,sans-serif",fontSize:13},splitLine:{show:!1},nameLocation:"end",nameTextStyle:{padding:[0,50,0,0]}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0}},N=function(e,n){window.addEventListener("resize",(function(){e.resize({width:n.clientWidth+"px",height:n.clientHeight+"px"})}),!0)},R=function(e){var n=e.some((function(e){return e.stack})),t=Array.from(new Set(e.map((function(e){return e.name})))).length,r=Math.max.apply(Math,e.reduce((function(e,n){var t=n.data;return e.concat(t.map((function(e){return e.value||0})))}),[]));return 0===r?"blank":(n?r*t<100:r<100)?"near":(n?r*t<1e3:r<1e3)?"middle":"far"},k=j,L="Volumes",V={Proportions:"Proportions",Volumes:"Absolute","%GNI":"%GNI"},M=function(e){return void 0===e&&(e=""),e.trim()?Number(e.replace(",","").replace(" ","").replace("%","").trim()):null},P=function(e){return e.map((function(e){var n=Object.assign({},e);return n.value=M(n.Value),n}))},T=function(e){return e.filter((function(e){return"%GNI"===L?"Total HA"===e:"Total HA"!==e}))},I=function(){return"%GNI"===L?"line":"bar"},B=function(e,n,t,r,a){void 0===a&&(a="Proportion");var o=e.filter((function(e){return e.Donor.trim()===t&&e["IHA type"]===r&&e["Value type"]===a}));return n.map((function(e){return o.find((function(n){return n.Year===e}))}))},U=function(e,n,t){return void 0===n&&(n="currency"),void 0===t&&(t="auto"),new Intl.NumberFormat("en-US",{style:n,currency:"USD",signDisplay:t,maximumFractionDigits:0}).format(e)},F=function(e){void 0===e&&(e="far");return"Volumes"!==L?{type:"value",axisLabel:{formatter:"{value}%"},name:"",max:"Proportions"===L?100:null}:{type:"value",axisLabel:{formatter:"{value}"},nameRotate:90,name:"US$ millions",nameLocation:"end",nameTextStyle:{verticalAlign:"top",align:"right",padding:{near:[-35,0,0,0],middle:[-45,0,0,0],far:[-60,0,0,0]}[e]},max:null}},Y=function(e,n,t){var r=t.years,a=t.channels,o={color:E.bluebell,legend:{show:!0,top:"top",padding:[20,10,5,10],textStyle:{fontSize:"1.3rem"}},grid:{bottom:"10%",top:"20%"},xAxis:{type:"category",data:r},yAxis:F(),series:T(a).map((function(e){return{name:e,data:B(n,r,"All donors",e,V[L]).map((function(e){return{value:e&&Number("Proportions"===L?100*e.value:e.value),emphasis:{focus:"self"}}})),type:I(),stack:"channels",tooltip:{trigger:"item",formatter:function(t){var r=n.find((function(n){return n["IHA type"]===e&&"All donors"===n.Donor&&""+n.Year===t.name&&n["Value type"]===V[L]})),a=e.includes("Multilateral HA")?e.replace("Multilateral HA","Multilateral Humanitarian Assistance"):e;return"All donors, "+t.name+" <br />"+a+": <strong>"+("Proportions"===L?t.value.toFixed(2)+"%":"US$"+U(M(r.Value),"decimal","never")+" million")+" </strong>"}},cursor:"auto"}}))};return o.yAxis=F(R(o.series)),k.toolbox.feature.saveAsImage.name="donors",e.setOption(i()(o,k),{replaceMerge:["series"]}),e.on("legendselectchanged",(function(n){_(e,n)})),e},z=function(e,n,t){var r=t.donors,a=t.channels,o=t.years,i=P(n),s=I(),l=r.map((function(e){return T(a).map((function(n,t){return{name:"%GNI"!==L?n:e,data:B(i,o,e,n,V[L]).map((function(e){return{value:e&&"number"==typeof e.value?Number("Volumes"!==L?100*e.value:e.value):null,emphasis:{focus:"self"}}})),type:s,stack:"%GNI"!==L?e:void 0,symbol:"circle",symbolSize:10,connectNulls:"line"!==s&&void 0,tooltip:{trigger:"item",formatter:function(t){var r=i.find((function(r){return r["IHA type"]===n&&r.Donor===e&&""+r.Year===t.name&&r["Value type"]===V[L]})),a="Volumes"===L?"US$"+U(M(r.Value),"decimal","never")+" million":t.value.toFixed(2)+"%";return e+", "+t.name+" <br />"+n+": <strong>"+a+"</strong>"}},label:{show:"bar"===s&&(0===t&&r.length>1),position:"insideBottom",distance:15,align:"left",verticalAlign:"middle",rotate:90,formatter:function(){return""+e},fontSize:16},cursor:"auto"}}))})).reduce((function(e,n){return e.concat(n)}),[]);e.setOption({yAxis:F(R(l)),series:l},{replaceMerge:["series"]})},$=function(){window.DICharts.handler.addChart({className:"dicharts--gha-donors",echarts:{onAdd:function(e){Array.prototype.forEach.call(e,(function(e){var n=new window.DICharts.Chart(e.parentElement);D("https://raw.githubusercontent.com/devinit/gha-data-visualisations/main/public/assets/data/donor_interactive_data_long.csv").then((function(t){var r=O(e),o=Array.from(new Set(t.map((function(e){return e.Donor})))).sort(),i=Array.from(new Set(t.map((function(e){return e.Year})))).sort(),l=Array.from(new Set(t.map((function(e){return e["IHA type"]})))),c=window.echarts.init(e);Y(c,P(t),{years:i,channels:l});var u=[];Object(s.createRoot)(r).render(Object(a.c)(C,{selectErrorMessage:"You can compare two donors. Please remove one before adding another.",donors:o,onSelectDataType:function(e){if(L=e||L,u.length){var n=t.filter((function(e){return u.includes(e.Donor)}));z(c,n,{donors:u,channels:l,years:i})}else Y(c,P(t),{years:i,channels:l})},onSelectDonor:function(e){if(e.length){var n=t.filter((function(n){return e.find((function(e){return e.value===n.Donor}))}));u=e.map((function(e){return e.value})),z(c,n,{donors:u,channels:l,years:i})}else Y(c,P(t),{years:i,channels:l})},defaultDonor:"All donors",defaultDataType:"Volumes",donorSelectErrorMessage:"You can compare two donors. Please remove one before adding another."})),n.hideLoading(),N(c,e)}))}))}}})},H=function(e){return void 0===e&&(e=""),e.trim()?Number(e.replace(",","").replace(" ","").replace("%","").trim()):null},G=function(e){return e.map((function(e){var n=Object.assign({},e);return n.value=H(e.Proportions),n}))},W=function(e,n,t,r){var a=e.filter((function(e){return e.Donor.trim()===t&&e["Delivery channel"]===r}));return n.map((function(e){return a.find((function(n){return n.Year===e}))}))},q=function(e,n,t){return void 0===n&&(n="currency"),void 0===t&&(t="auto"),new Intl.NumberFormat("en-US",{style:n,currency:"USD",signDisplay:t,maximumFractionDigits:0}).format(e)},J=function(e,n,t){var r=t.years,a=t.channels,o={color:E.bluebell,legend:{show:!0,top:"top",padding:[20,10,5,10],textStyle:{fontSize:"1.3rem"}},grid:{bottom:"10%",top:"20%"},xAxis:{type:"category",data:r},yAxis:{type:"value",axisLabel:{formatter:"{value}%"},max:100},series:a.map((function(e){return{name:e,data:W(n,r,"All donors",e).map((function(e){return{value:e&&Number(100*e.value).toFixed(2),emphasis:{focus:"self"}}})),type:"bar",stack:"channels",tooltip:{trigger:"item",formatter:function(t){var r=n.find((function(n){return n["Delivery channel"]===e&&"All donors"===n.Donor&&""+n.Year===t.name}));return"All donors, "+t.name+" <br />"+e+": <strong>"+Number(t.value,10).toFixed(2)+"%</strong> (US$"+q(H(r["US$ millions, constant 2020 prices"]),"decimal","never")+" million)"}},cursor:"auto"}}))};return k.toolbox.feature.saveAsImage.name="funding-channels",e.setOption(i()(o,k),{replaceMerge:["series"]}),e.on("legendselectchanged",(function(n){_(e,n)})),e},Z=function(){window.DICharts.handler.addChart({className:"dicharts--boilerplate-chart",echarts:{onAdd:function(e){Array.prototype.forEach.call(e,(function(e){var n=new window.DICharts.Chart(e.parentElement);D("https://raw.githubusercontent.com/devinit/gha-data-visualisations/main/public/assets/data/funding-channels-interactive-data.csv").then((function(t){var r,a,o,i=O(e),l=Array.from(new Set(t.map((function(e){return e.Donor})))),c=Array.from(new Set(t.map((function(e){return e.Year})))),d=(r=Array.from(new Set(t.map((function(e){return e["Delivery channel"]})))),a=["Not reported","Other"],o=r.filter((function(e){return!a.includes(e)})),a.forEach((function(e){r.includes(e)&&o.push(e)})),o),f=window.echarts.init(e);J(f,G(t),{years:c,channels:d});var p=[];Object(s.createRoot)(i).render(u.a.createElement(g,{selectErrorMessage:"You can compare two donors. Please remove one before adding another."},u.a.createElement(S,{label:"Select up to two donors",options:l.map((function(e){return{value:e,label:e,isCloseable:!0}})),defaultValue:[{value:"All donors",label:"All donors",isCloseable:!0}],isMulti:!0,onChange:function(e){if(e.length){var n=t.filter((function(n){return e.find((function(e){return e.value===n.Donor}))}));p=e.map((function(e){return e.value})),function(e,n,t){var r=t.donors,a=t.channels,o=t.years,i=G(n),s=r.map((function(e){return a.map((function(n,t){return{name:n,data:W(i,o,e,n).map((function(e){return{value:e&&Number(100*e.value).toFixed(2),emphasis:{focus:"self"}}})),type:"bar",stack:e,tooltip:{trigger:"item",formatter:function(t){var r=i.find((function(r){return r["Delivery channel"]===n&&r.Donor===e&&""+r.Year===t.name})),a=r?"<strong>"+(100*r.value).toFixed(2)+"%</strong> (US$"+q(H(r["US$ millions, constant 2020 prices"]),"decimal","never")+" million)":"<strong>"+(100*r.value).toFixed(2)+"%</strong>";return e+", "+t.name+" <br />"+n+": "+a}},label:{show:0===t&&r.length>1,position:"insideBottom",distance:15,align:"left",verticalAlign:"middle",rotate:90,formatter:function(){return""+e},fontSize:16},cursor:"auto"}}))})).reduce((function(e,n){return e.concat(n)}),[]);e.setOption({series:s},{replaceMerge:["series"]})}(f,n,{donors:p,channels:d,years:c})}else J(f,G(t),{years:c,channels:d})},css:{minWidth:"200px"},classNamePrefix:"channels-chart-select",isClearable:!1}))),n.hideLoading(),N(f,e)}))}))}}})},K=t(164),Q=t.n(K),X=t(228),ee=function(e){var n=Object(c.useState)(e.donorRecipients),t=n[0],r=n[1],o=Object(c.useState)(e.defaultBreakdown),i=o[0],s=o[1],l=Object(c.useState)(e.defaultRecipient),u=l[0],d=l[1];Object(c.useEffect)((function(){r("By donor"===i?e.donorRecipients:e.orgTypeRecipients),e.onSelectBreakdown&&e.onSelectBreakdown(i,u)}),[i]),Object(c.useEffect)((function(){e.onSelectRecipient&&e.onSelectRecipient(u,i)}),[u]);return Object(a.c)(g,null,Object(a.c)(S,{classNamePrefix:"recipient-chart-select",label:"Select recipient",options:t.sort().map((function(e){return{value:e,label:e}})),defaultValue:[{value:e.defaultRecipient,label:e.defaultRecipient}],onChange:function(n){d(n.value||e.defaultRecipient)},css:{minWidth:"150px"}}),Object(a.c)(S,{classNamePrefix:"recipient-chart-breakdown",label:"Choose breakdown",options:["By donor","By type of organisation receiving funding"].map((function(e){return{value:e,label:e}})),defaultValue:[{value:e.defaultBreakdown,label:e.defaultBreakdown}],onChange:function(n){s(n.value||e.defaultBreakdown)},css:{minWidth:"300px"}}))};ee.propTypes={donorRecipients:f.a.array,orgTypeRecipients:f.a.array,defaultRecipient:f.a.string,defaultBreakdown:f.a.string,onSelectBreakdown:f.a.func,onSelectRecipient:f.a.func},ee.defaultProps={defaultBreakdown:"By donor",defaultRecipient:"Afghanistan"};var ne=ee,te=new Intl.NumberFormat,re=function(e){return e.trim()?Number(e.replace(",","").replace(" ","").replace("%","").trim()).toFixed(2):null},ae=function(e,n){return void 0===n&&(n="Value"),e.map((function(e){var t=Object.assign({},e);return t.value=re(e[n]),t}))},oe=function(e,n,t,r){var a=e.filter((function(e){return e["Destination Country"].trim()===t&&e["Donor organisation"]===r}));return n.map((function(e){return a.find((function(n){return n.Year===e}))||null}))},ie=function(e,n,t){var r=["Destination Country","Recipient Org Type"],a=e.filter((function(e){return e[r[1]]===n}));return t.map((function(e){var n=a.find((function(n){return n.Year===e}));return{value:n&&re(n.value)||null,emphasis:{focus:"self"}}}))},se=function(e,n){var t=["US","EU institutions","Germany","UK","Saudi Arabia","All other donors"],r=e.filter((function(e){return e["Destination Country"].trim()===n}));return t.length>=5?t:Array.from(new Set(r.map((function(e){return e["Donor organisation"]})))).filter((function(e){return!t.includes(e)})).slice(0,5).concat(t)},le=function(e){void 0===e&&(e="far");return{type:"value",nameRotate:90,name:"US$ millions",nameLocation:"end",nameTextStyle:{verticalAlign:"top",align:"right",padding:{near:[-35,0,0,0],middle:[-45,0,0,0],far:[-54,0,0,0]}[e]}}},ce=function(e,n,t,r){var a=r.years,o=r.channels,s={color:E.bluebell,legend:{show:!0,top:"top",padding:[20,10,5,10],textStyle:{fontSize:"1.3rem"}},grid:{bottom:"10%",top:"20%"},xAxis:{type:"category",data:a,position:"bottom"},series:o.map((function(e){return{name:e,data:oe(n,a,t,e).map((function(e){return{value:e&&Number(e.value).toFixed(2),emphasis:{focus:"self"}}})),type:"bar",stack:"channels",cursor:"auto",tooltip:{trigger:"item",formatter:function(n){return e+", "+n.name+" <br />10 largest recipients: <strong>US$"+te.format(Math.round(n.value))+" million</strong>"}},animation:!1}}))};return s.yAxis=le(R(s.series)),k.toolbox.feature.saveAsImage.name="recipients",e.setOption(i()(s,k),{replaceMerge:["series"]}),e.on("legendselectchanged",(function(n){_(e,n)})),e},ue=function(e,n,t){var r=t.recipient,a=t.years,o=ae(n,"USD deflated millions"),i=se(n,r).map((function(e){return{name:e,data:oe(o,a,r,e).map((function(e){return{value:e&&Number(e.value).toFixed(2),emphasis:{focus:"self"}}})),type:"bar",stack:r,cursor:"auto",tooltip:{trigger:"item",formatter:function(n){return e+", "+n.name+" <br/>"+r+": <strong>US$"+te.format(Math.round(n.value))+" million</strong>"}}}})).reduce((function(e,n){return e.concat(n)}),[]);e.setOption({yAxis:le(R(i)),series:i},{replaceMerge:["series"]})},de=function(e,n,t){var r=t.recipient,a=t.years,o=function(e){var n=["Not reported","Other"],t=e.filter((function(e){return!n.includes(e)}));return n.forEach((function(n){e.includes(n)&&t.push(n)})),t}(function(e,n){var t=e.filter((function(e){return e["Destination Country"].trim()===n}));return Array.from(new Set(t.map((function(e){return e["Recipient Org Type"]}))))}(n,r)).map((function(e){return{name:e,data:ie(n,e,a),type:"bar",stack:r,cursor:"auto",tooltip:{trigger:"item",formatter:function(n){return n.name+" <br/>"+e+": <strong>US$"+te.format(Math.round(n.value))+" million</strong>"}}}})).reduce((function(e,n){return e.concat(n)}),[]);e.setOption({yAxis:le(R(o)),series:o},{replaceMerge:["series"]})},fe=function(){window.DICharts.handler.addChart({className:"dicharts--gha-recipients",echarts:{onAdd:function(e){Array.prototype.forEach.call(e,function(){var e=Object(X.a)(Q.a.mark((function e(n){var t,r,a,o,i,l,c,d,f,p,m,b;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new window.DICharts.Chart(n.parentElement),e.next=3,D("https://raw.githubusercontent.com/devinit/gha-data-visualisations/main/public/assets/data/recipients-by-donor.csv");case 3:return r=e.sent,e.next=6,D("https://raw.githubusercontent.com/devinit/gha-data-visualisations/main/public/assets/data/recipients-by-org-type.csv");case 6:a=e.sent,o=O(n),i=Array.from(new Set(r.filter((function(e){return"Yes"===e["Top 10 recipient"]})).map((function(e){return e["Destination Country"]})))),l=Array.from(new Set(r.map((function(e){return e.Year})))),"Afghanistan","By donor",c=se(r,"Afghanistan"),d=Array.from(new Set(a.filter((function(e){return"Yes"===e["Top 10 recipient"]})).map((function(e){return e["Destination Country"]})))),f=window.echarts.init(n),ce(f,ae(r,"USD deflated millions"),"Afghanistan",{years:l,channels:c}),p="Afghanistan",m=function(e,n){if(void 0===n&&(n="By donor"),p=e||"Afghanistan","By donor"===n)if("10 largest recipients"!==p){var t=r.filter((function(e){return e["Destination Country"]===p}));ue(f,t,{recipient:p,years:l})}else p="10 largest recipients",ce(f,ae(r,"USD deflated millions"),"10 largest recipients",{years:l,channels:c});else de(f,a.filter((function(n){return n["Destination Country"]===e})),{recipient:e,years:l})},b=function(e,n){if("By donor"===e)if("10 largest recipients"!==n){var t=r.filter((function(e){return e["Destination Country"]===n}));ue(f,t,{recipient:n,years:l})}else ce(f,ae(r,"USD deflated millions"),"10 largest recipients",{years:l,channels:c});else de(f,a.filter((function(e){return e["Destination Country"]===n})),{recipient:n,years:l})},Object(s.createRoot)(o).render(u.a.createElement(ne,{donorRecipients:i,orgTypeRecipients:d,onSelectRecipient:m,onSelectBreakdown:b,defaultBreakdown:"By donor",defaultRecipient:"Afghanistan"})),t.hideLoading(),N(f,n);case 23:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}())}}})},pe=(t(580),"https://devinit.org/assets/svg/icons/response-plan-icon.svg"),me=function(e){var n=[];return Number(e.Conflict_marker)>0&&n.push("Conflict"),Number(e.Displacement_marker)>0&&n.push("Displacement"),Number(e.Physical_disaster_marker)>0&&n.push("Natural hazard"),n.join(", ")},be=function(e){switch(e){case"5":return"Very high";case"4":return"High";case"3":return"Medium";case"2":return"Low";case"1":return"Very Low";case"":return"Not assessed";default:return""}},ge=function(e){return e["Protracted/Recurrent_crisis"]+", "+e.Years_of_consecutive_crisis+" years"},ve=function(e,n){return e?Math.round(Number(n)/Number(e)*100)+"% funded[US$"+n+" of "+e+"]":"Not assessed"},he=function(){var e=window.L.DomUtil.create("div","legend"),n=[{score:"5",label:"5 - Very High"},{score:"4",label:"4 - High"},{score:"3",label:"3 - Medium"},{score:"2",label:"2 - Low"},{score:"1",label:"1 - Very Low"},{score:"",label:"Not assessed"}].map((function(e){return'<span><i style="background:'+function(e){switch(e){case"5":return"#7F1850";case"4":return"#AD1156";case"3":return"#D64279";case"2":return"#E4819B";case"1":return"#F6B9C2";case"":return"repeating-linear-gradient(45deg, grey 0, grey 3px, transparent 3px, transparent 6px)";default:return"#E6E1E5"}}(e.score)+'"></i><label>'+e.label+"</label></span>"})).join("");return e.innerHTML=n,e},ye=window.L.control({position:"bottomright"});ye.onAdd=function(){return this.div=window.L.DomUtil.create("div","databox"),this.div.setAttribute("data-id","databoxContainer"),this.update(),this.div},ye.update=function(e){var n,t,r;this.div.innerHTML=e?"<div>"+e.name+" <button id=closeDatabox><img src=https://devinit.org/assets/svg/icons/cross.colors-poppy-slate-blank-poppydark.svg height=20 width=20 ></img></button></div> <br> "+(n=e,[{value:n["People_in_need_(millions)"],label:"People in need",icon:"https://devinit.org/assets/svg/icons/people-in-need-icon.svg"},{value:me(n),label:"Crisis type",icon:"https://devinit.org/assets/svg/icons/crisis-type-icon.svg"},{value:be(n.Severity_score),label:"Severity of crisis",icon:"https://devinit.org/assets/svg/icons/crisis-severity-icon.svg"},{value:ge(n),label:"Crisis duration",icon:"https://devinit.org/assets/svg/icons/crisis-duration-icon.svg"},{value:n.COVID_vaccination_rate+"% of the population vaccinated",label:"Covid vaccinations",icon:"https://devinit.org/assets/svg/icons/covid-vaccination-icon.svg"},{value:be(n.Climate_vulnerability),label:"Climate vulnerability",icon:"https://devinit.org/assets/svg/icons/climate-vulnerability-icon.svg"},{value:(t=n["Country_response_plan_requirements_(US$,_million)"],r=n["Country_response_plan_coverage_(%)"],t?r+"% funded[US$"+Math.round(Number(r)/100*Number(t))+"  of "+t+"]":"Not assessed"),label:"Country response plan",icon:pe},{value:ve(n["Regional_response_plan_requirements_(US$,_million)"],n["Regional_response_plan_funding_(US$,_million)"]),label:"Regional response plan",icon:pe}]).map((function(e){return"<span><img src="+e.icon+" height=20 width=20 ></img><p>"+e.label+": "+e.value+"</p> </span>"})).join(""):"";var a=document.getElementById("closeDatabox");a&&a.addEventListener("click",(function(e){return function(e,n){e.stopPropagation(),n.update(),document.querySelector('[data-id="databoxContainer"]').style.display="none"}(e,ye)}))};var we=function(){window.DICharts.handler.addChart({className:"dicharts--gha-people-affected-by-crisis-leaflet",echarts:{onAdd:function(e){Array.prototype.forEach.call(e,(function(e){var n,t=new window.DICharts.Chart(e.parentElement),r=window.L.map(e).setView([20,-.09],2),a="Severity_score",o=window.L.control({position:"topright"});o.onAdd=he,o.addTo(r);var i=new window.L.StripePattern({weight:2,spaceWeight:1,angle:45,color:"grey"});i.addTo(r);t.showLoading(),window.fetch("https://raw.githubusercontent.com/devinit/gha-data-visualisations/main/public/assets/data/world_map.geo.json").then((function(e){return e.json()})).then((function(e){var o=e.features;D("https://raw.githubusercontent.com/devinit/gha-data-visualisations/main/public/assets/data/map_data_long.csv").then((function(e){var s,l=(s=o,e.map((function(e){var n=Object.assign({},e),t=s.find((function(e){return e.properties.iso_a3===n.Country_ID}));return t&&(n.Country_name=t.properties.name),n}))),c=function(e,n){var t=[];return e.forEach((function(e){var r={};r.name=e,n.forEach((function(n){n.Country_name===e&&(r[n.variable]=n.value)})),t.push(r)})),t}(Array.from(new Set(l.map((function(e){return e.Country_name})))),l),u=[{name:"Severity_score",label:"Severity score"},{name:"Climate_vulnerability",label:"Climate vulnerability score"},{name:"COVID_vaccination_rate",label:"COVID vaccinattion rate"},{name:"Food_insecure_(millions)",label:"People facing food insecurity"},{name:"People_in_need_(millions)",label:"People in need"}],d=function(e){n.resetStyle(e.target),e.target.closePopup()};n=window.L.geoJSON(function(e,n){return e.map((function(e){var t=Object.assign({},e),r=n.find((function(n){return n.name===e.properties.name}));return r&&(t.properties=Object.assign({},e.properties,r)),t}))}(o,c),{style:function(e){var n;return(n={})[""===e.properties[a]?"fillPattern":"fillColor"]=function(e){switch(e){case"5":return"#7F1850";case"4":return"#AD1156";case"3":return"#D64279";case"2":return"#E4819B";case"1":return"#F6B9C2";case"":return i;default:return"#E6E1E5"}}(e.properties[a]),n.weight=1,n.opacity=1,n.color="white",n.fillOpacity=1,n},onEachFeature:function(e,n){(e.properties[a]||""===e.properties[a])&&n.on({mouseover:function(e){return function(e,n,t){var r=e.target;r.setStyle({fillColor:"yellow",color:"black",weight:2}),window.L.Browser.ie||window.L.Browser.opera||window.L.Browser.edge||r.bringToFront(),r.bindPopup(r.feature.properties[n]?"<div>"+r.feature.properties.name+"<br>"+t.find((function(e){return e.name===n})).label+": "+r.feature.properties[n]+"</div>":r.feature.properties.name).openPopup()}(e,a,u)},mouseout:d,click:function(e){return function(e,n,t){t.addTo(n);var r=e.target;t.update(r.feature.properties)}(e,r,ye)}})},maxZoom:3,minZoom:2}).addTo(r),t.hideLoading()}))})).catch((function(e){return console.log(e)}))}))}}})};t(581);window.addEventListener("load",(function(){$(),Z(),fe(),we()}))}},[[231,1,2]]]);