(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{253(e,t,n){e.exports=n(626)},624(e,t,n){},626(e,t,n){n.r(t);n(254),n(262),n(263),n(264),n(265),n(266),n(267),n(268),n(269),n(270),n(271),n(272),n(273),n(274),n(275),n(276),n(277),n(278),n(279),n(280),n(281),n(282),n(283),n(285),n(124),n(286),n(287),n(288),n(289),n(290),n(291),n(292),n(293),n(295),n(296),n(297),n(299),n(300),n(301),n(303),n(304),n(305),n(166),n(307),n(308),n(309),n(310),n(311),n(312),n(313),n(314),n(315),n(316),n(317),n(319),n(320),n(321),n(322),n(323),n(324),n(325),n(326),n(327),n(328),n(329),n(330),n(331),n(332),n(333),n(334),n(336),n(337),n(338),n(339),n(340),n(341),n(342),n(343),n(344),n(345),n(346),n(347),n(348),n(349),n(350),n(351),n(352),n(353),n(354),n(355),n(356),n(357),n(358),n(360),n(361),n(371),n(372),n(373),n(375),n(376),n(377),n(378),n(379),n(380),n(381),n(382),n(383),n(384),n(385),n(386),n(224),n(388),n(389),n(390),n(392),n(393),n(394),n(395),n(225),n(396),n(397),n(398),n(399),n(400),n(401),n(402),n(403),n(404),n(405),n(406),n(408),n(410),n(411),n(412),n(413),n(414),n(415),n(416),n(417),n(418),n(419),n(420),n(421),n(422),n(423),n(427),n(428),n(429),n(430),n(431),n(432),n(433),n(434),n(435),n(436),n(437),n(438),n(441),n(442),n(443),n(444),n(445),n(446),n(447),n(448),n(449),n(451),n(452),n(453),n(454),n(455),n(456),n(457),n(458),n(459),n(460),n(461),n(462),n(177),n(464),n(466),n(474),n(475),n(476),n(477),n(478),n(480),n(481),n(482),n(483),n(484),n(485),n(486),n(487),n(489),n(490),n(491),n(492),n(493),n(494),n(495),n(496),n(497),n(498),n(499),n(500),n(501),n(502),n(503),n(504),n(505),n(506),n(507),n(508),n(509),n(510),n(511),n(512),n(516),n(518),n(520),n(521),n(522),n(523),n(524),n(526),n(527),n(528),n(529),n(530),n(531),n(532),n(533),n(537),n(538),n(539),n(540),n(541),n(543),n(545),n(547),n(549),n(550),n(551),n(552),n(553),n(554),n(556),n(558),n(559),n(560),n(562),n(564),n(565),n(566),n(567),n(569),n(570),n(571),n(572),n(573),n(574),n(575),n(577),n(578),n(583),n(584),n(587),n(588);let a; const r=n(2); const i=n(71); const o=n.n(i); const l=n(48); const s=n(143); const c=n(1); const u=n.n(c); const d=n(8); const f=n.n(d); const p=n(248); const m=n(252).a.div(a||(a=Object(p.a)(["\n  color: red;\n  font-size: 11px;\n  position: relative;\n  padding: 5px 5px 5px 0px;\n  display: block;\n"]))); const b=function(e){const t=Object(c.useState)(""); const n=t[0]; const a=t[1]; const r=function(t){t?t.type==="maxSelectedOptions"&&a(e.selectErrorMessage):a("")};

return u.a.createElement("div",null,u.a.Children.map(e.children,((e) =>u.a.isValidElement(e)?u.a.cloneElement(e,{onError:r}):e)),n?u.a.createElement(m,{className:"data-selector--wrapper"},n):null)};b.propTypes={selectErrorMessage:f.a.string,children:f.a.node};const h=b; const g=n(249); const v=n(251); const y={control(e){return {...e,borderColor:"#ddd",borderRadius:"none",boxShadow:"none",":hover":{borderColor:"#8f1b13"},":active":{borderColor:"#8f1b13"}}},option(e){return {...e,fontSize:"14px"}},singleValue(e){return {...e,fontSize:"14px"}},multiValue(e){return {...e,fontSize:"14px"}},multiValueLabel(e,t){return t.data.isCloseable?e:({...e,paddingRight:6})},multiValueRemove(e,t){return t.data.isCloseable?e:({...e,display:"none"})},input(e){return {...e,fontSize:"14px"}},indicatorsContainer(e){return {...e,pointerEvents:"none"}}}; const w=function(e){const t=e.label; const n=e.onError; const a=e.maxSelectedOptions; const i=e.defaultValue; const o=e.singleSelectOptions; const l=Object(s.a)(e,["label","onError","maxSelectedOptions","defaultValue","singleSelectOptions"]); const u=Object(c.useState)(i); const d=u[0]; const f=u[1];Object(c.useEffect)((() =>{l.onChange&&l.onChange(d),n&&n()}),[d]);

return Object(r.b)("div",{className:"labelled-data-selector--wrapper"},Object(r.b)("label",null,Object(r.b)("b",null,t)),Object(r.b)(v.a,Object(g.a)({},l,{value:d,onChange(e){if(l.isMulti)if(e.length){const t=e.findIndex(((e) =>o.find(((t) =>t.value===e.value))));l.isMulti&&e.length>1&&t!==-1?f(t===0?e.slice(1):[e[t]]):a&&e.length>a?n&&n({type:"maxSelectedOptions",message:`Only up to ${a} selections allowed`}):f(e)}else f(i);else f(e)},css:{marginRight:"10px"},styles:y,isClearable:l.isClearable!=="undefined"?l.isClearable:d.length>1})))};w.propTypes={label:f.a.string,options:f.a.array,maxSelectedOptions:f.a.number,onChange:f.a.func,onError:f.a.func,defaultValue:f.a.array,singleSelectOptions:f.a.array,isMulti:f.a.bool,isClearable:f.a.bool},w.defaultProps={maxSelectedOptions:2,singleSelectOptions:[]};const S=w; const C=function(e){const t=e.defaultDonor; const n=e.onSelectDonor; const a=Object(s.a)(e,["defaultDonor","onSelectDonor"]); const r=Object(c.useState)(a.donors); const i=r[0]; const o=r[1]; const l=Object(c.useState)(a.defaultDataType); const d=l[0]; const f=l[1];Object(c.useEffect)((() =>{o(a.donors)}),[a.donors]);

return u.a.createElement(h,{selectErrorMessage:a.donorSelectErrorMessage},u.a.createElement(S,{label:"Select up to two donors",options:i.map(((e) =>({value:e,label:e,isCloseable:!0}))),defaultValue:[{value:t,label:t,isCloseable:!0}],isMulti:!0,onChange:n,css:{minWidth:"200px"},classNamePrefix:"donors-select",isClearable:!1}),u.a.createElement(S,{label:"Display data as",options:["Volumes","Proportions","%GNI"].map(((e) =>({value:e,label:e}))),defaultValue:[{value:d,label:d}],value:d,onChange(e){f(e?e.value:a.defaultDataType),a.onSelectDataType&&a.onSelectDataType(e?e.value:a.defaultDataType)},css:{minWidth:"150px"},classNamePrefix:"donors-display-data-as"}))};C.propTypes={donors:f.a.array,donorSelectErrorMessage:f.a.string,onSelectDonor:f.a.func,onSelectDataType:f.a.func,defaultDonor:f.a.string,defaultDataType:f.a.string};const _=C; const x=n(250); const E=function(e){return new Promise(((t) =>{Object(x.parse)(e,{download:!0,header:!0,skipEmptyLines:!0,complete(e){const n=e.data;

return t(n)}})}))}; const A=function(e){let t; const n=document.createElement("div");

return(t=n.classList).add.apply(t,["spotlight-banner","data-selector--wrapper"]),e.parentElement.insertBefore(n,e),n}; const O={rainbow:["#e84439","#eb642b","#f49b21","#109e68","#0089cc","#893f90","#c2135b","#f8c1b2","#f6bb9d","#fccc8e","#92cba9","#88bae5","#c189bb","#e4819b"],default:["#6c120a","#a21e25","#cd2b2a","#dc372d","#ec6250","#f6b0a0","#fbd7cb","#fce3dc"],sunflower:["#7d4712","#ba6b15","#df8000","#f7a838","#fac47e","#fedcab","#fee7c1","#feedd4"],marigold:["#7a2e05","#ac4622","#cb5730","#ee7644","#f4a57c","#facbad","#fcdbbf","#fde5d4"],rose:["#65093d","#8d0e56","#9f1459","#d12568","#e05c86","#f3a5b6","#f6b8c1","#f9cdd0"],lavendar:["#42184c","#632572","#732c85","#994d98","#af73ae","#cb98c4","#deb5d6","#ebcfe5"],bluebell:["#0c457b","#0071b1","#0089cc","#5da3d9","#77adde","#88bae5","#bcd4f0","#d3e0f4"],leaf:["#08492f","#005b3e","#00694a","#3b8c62","#74bf93","#a2d1b0","#b1d8bb","#c5e1cb"],orange:["#973915","#d85b31","#eb642b","#f18e5e","#f4a57c","#f6bb9d"]}; const N=function(e,t){const n=t.selected; const a=Object.values(n).filter(((e) =>e)).length;e.setOption({animation:!0}),a===0?Object.keys(n).forEach(((t) =>{e.dispatchAction({type:"legendSelect",name:t})})):n[t.name]||(e.dispatchAction({type:"legendSelect",name:t.name}),Object.keys(n).forEach(((a) =>{Object.prototype.hasOwnProperty.call(n,a)&&a!==t.name&&e.dispatchAction({type:"legendUnSelect",name:a})})))}; const T={color:O.default.concat(O.rainbow),legend:{left:"10%",top:10,textStyle:{fontFamily:"Geomanist Regular,sans-serif"}},tooltip:{show:!0,trigger:"item",showContent:!0,textStyle:{fontFamily:"Geomanist Regular,sans-serif"}},toolbox:{show:!0,showTitle:!1,feature:{saveAsImage:{title:"Save as PNG",pixelRatio:2}},right:20,tooltip:{show:!0,formatter(e){return`<div>${e.title}</div>`},textStyle:{fontFamily:"Geomanist Regular,sans-serif"}}},xAxis:{axisLabel:{fontFamily:"Geomanist Regular,sans-serif",fontSize:13},splitLine:{show:!1}},yAxis:{axisLabel:{fontFamily:"Geomanist Regular,sans-serif",fontSize:13},splitLine:{show:!1},nameLocation:"end",nameTextStyle:{padding:[0,50,0,0]}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0}}; const D=function(e,t){window.addEventListener("resize",(() =>{e.resize({width:`${t.clientWidth}px`,height:`${t.clientHeight}px`})}),!0)}; const L=function(e){const t=e.some(((e) =>e.stack)); const n=Array.from(new Set(e.map(((e) =>e.name)))).length; const a=Math.max.apply(Math,e.reduce(((e,t) =>{const n=t.data;

return e.concat(n.map(((e) =>e.value||0)))}),[]));

return a===0?"blank":(t?a*n<100:a<100)?"near":(t?a*n<1e3:a<1e3)?"middle":"far"}; const j=T; const M=["#f49b21","#fccc8e","#f9b865"]; let V="Volumes"; const R={Proportions:"Proportions",Volumes:"Volumes","%GNI":"%GNI"}; const U=function(e){return void 0===e&&(e=""),e.trim()?Number(e.replace(",","").replace(" ","").replace("%","").trim()):null}; const k=function(e){return e.map(((e) =>{const t={...e};

return t.value=U(t.Value),t}))}; const I=function(){return V==="%GNI"?"line":"bar"}; const F=function(e,t,n,a,r){void 0===r&&(r="Proportions");const i=e.filter(((e) =>e.Donor.trim()===n&&e.Series===a&&e.Display===r));

return t.map(((e) =>i.find(((t) =>t.Year===e))))}; const P=function(e,t,n){return void 0===t&&(t="currency"),void 0===n&&(n="auto"),new Intl.NumberFormat("en-US",{style:t,currency:"USD",signDisplay:n,maximumFractionDigits:0}).format(e)}; const B=function(e){void 0===e&&(e="far");

return V!=="Volumes"?{type:"value",axisLabel:{formatter:"{value}%"},name:"",max:V==="Proportions"?100:null}:{type:"value",axisLabel:{formatter:"{value}"},nameRotate:90,name:"US$ millions",nameLocation:"end",nameTextStyle:{verticalAlign:"top",align:"right",padding:{near:[-35,0,0,0],middle:[-45,0,0,0],far:[-60,0,0,0]}[e]},max:null}}; const $=function(e,t,n){const a=n.years; const r=n.channels; const i={color:M,legend:{show:!0,top:"top",padding:[20,10,5,10],textStyle:{fontSize:"1.3rem"}},grid:{bottom:"10%",top:"20%"},xAxis:{type:"category",data:a},yAxis:B(),series:r.map(((e) =>({name:e,data:F(t,a,"All donors",e,R[V]).map(((e) =>({value:e?e.value:null,emphasis:{focus:"self"}}))),type:I(),stack:"channels",tooltip:{trigger:"item",formatter(n){const a=t.find(((t) =>t.Series===e&&t.Donor==="All donors"&&`${t.Year}`===n.name&&t.Display===R[V])); const r=e.includes("Multilateral HA")?e.replace("Multilateral HA","Multilateral Humanitarian Assistance"):e;

return`All donors, ${n.name} <br />${r}: <strong>${V==="Proportions"?`${n.value.toFixed(2)}%`:`US$${P(U(a.Value),"decimal","never")} million`} </strong>`}},cursor:"auto"})))};

return i.yAxis=B(L(i.series)),j.toolbox.feature.saveAsImage.name="donors",e.setOption(o()(i,j),{replaceMerge:["series"]}),e.on("legendselectchanged",((t) =>{N(e,t)})),e}; const G=function(e,t,n){const a=n.donors; const r=n.channels; const i=n.years; const o=k(t); const l=I(); const s=a.map(((e) =>r.map(((t,n) =>({name:V!=="%GNI"?t:e,data:F(o,i,e,t,R[V]).map(((e) =>({value:e&&typeof e.value==="number"?e.value:null,emphasis:{focus:"self"}}))),type:l,stack:V!=="%GNI"?e:void 0,symbol:"circle",symbolSize:10,connectNulls:l!=="line"&&void 0,tooltip:{trigger:"item",formatter(n){const a=o.find(((a) =>a.Series===t&&a.Donor===e&&`${a.Year}`===n.name&&a.Display===R[V])); const r=V==="Volumes"?`US$${P(U(a.Value),"decimal","never")} million`:`${n.value.toFixed(2)}%`;

return `${e}, ${n.name} <br />${V==="%GNI"?"Total HA":t}: <strong>${r}</strong>`}},label:{show:l==="bar"&&(n===0&&a.length>1),position:"insideBottom",distance:15,align:"left",verticalAlign:"middle",rotate:90,formatter(){return`${e}`},fontSize:16},cursor:"auto"}))))).reduce(((e,t) =>e.concat(t)),[]);e.setOption({yAxis:B(L(s)),series:s},{replaceMerge:["series"]})}; const z=function(){window.DICharts.handler.addChart({className:"dicharts--gha-donors",echarts:{onAdd(e){Array.prototype.forEach.call(e,((e) =>{const t=new window.DICharts.Chart(e.parentElement);E("https://raw.githubusercontent.com/devinit/gha-data-visualisations/feature/climate-map/public/assets/data/donor_interactive_data_long.csv").then(((n) =>{const a=A(e); const i=Array.from(new Set(n.map(((e) =>e.Donor)))).sort(); const o=Array.from(new Set(n.map(((e) =>e.Year)))).sort(); const s=Array.from(new Set(n.map(((e) =>e.Series)))); const c=window.echarts.init(e);$(c,k(n),{years:o,channels:s});let u=[];Object(l.createRoot)(a).render(Object(r.b)(_,{selectErrorMessage:"You can compare two donors. Please remove one before adding another.",donors:i,onSelectDataType(e){if(V=e||V,u.length){const t=n.filter(((e) =>u.includes(e.Donor)));G(c,t,{donors:u,channels:s,years:o})}else $(c,k(n),{years:o,channels:s})},onSelectDonor(e){if(e.length){const t=n.filter(((t) =>e.find(((e) =>e.value===t.Donor))));u=e.map(((e) =>e.value)),G(c,t,{donors:u,channels:s,years:o})}else $(c,k(n),{years:o,channels:s})},defaultDonor:"All donors",defaultDataType:"Volumes",donorSelectErrorMessage:"You can compare two donors. Please remove one before adding another."})),t.hideLoading(),D(c,e)}))}))}}})}; const W=["#f49b21","#feedd4","#fccc8e","#f9b865","#e48a00","#a85d00","#7d4712"]; const Y=function(e){return void 0===e&&(e=""),e.trim()?Number(e.replace(",","").replace(" ","").replace("%","").trim()):null}; const H=function(e){return e.map(((e) =>{const t={...e};

return t.value=Y(e.Value),t}))}; const q=function(e,t,n,a){const r=e.filter(((e) =>e.Donor.trim()===n&&e.Series===a));

return t.map(((e) =>r.find(((t) =>t.Year===e))))}; const J=function(e,t,n){const a=n.years; const r=n.channels; const i={color:W,legend:{show:!0,top:"top",padding:[20,10,5,10],textStyle:{fontSize:"1.3rem"}},grid:{bottom:"10%",top:"20%"},xAxis:{type:"category",data:a},yAxis:{type:"value",axisLabel:{formatter:"{value}%"},max:100},series:r.map(((e) =>({name:e,data:q(t,a,"All donors",e).map(((e) =>({value:e&&Number(e.value),emphasis:{focus:"self"}}))),type:"bar",stack:"channels",tooltip:{trigger:"item",formatter(n){let a; let r; let i; const o=t.find(((t) =>t.Series===e&&t.Donor==="All donors"&&`${t.Year}`===n.name));

return`All donors, ${n.name} <br />${e}: <strong>${Number(n.value,10).toFixed(2)}%</strong> (US$${a=Y(o["US$ millions, constant 2020 prices"]),void 0===(r="decimal")&&(r="currency"),void 0===(i="never")&&(i="auto"),`${new Intl.NumberFormat("en-US",{style:r,currency:"USD",signDisplay:i,maximumFractionDigits:0}).format(a)} million)`}`}},cursor:"auto"})))};

return j.toolbox.feature.saveAsImage.name="funding-channels",e.setOption(o()(i,j),{replaceMerge:["series"]}),e.on("legendselectchanged",((t) =>{N(e,t)})),e}; const Z=function(){window.DICharts.handler.addChart({className:"dicharts--boilerplate-chart",echarts:{onAdd(e){Array.prototype.forEach.call(e,((e) =>{const t=new window.DICharts.Chart(e.parentElement);E("https://raw.githubusercontent.com/devinit/gha-data-visualisations/feature/climate-map/public/assets/data/funding-channels-interactive-data.csv").then(((n) =>{let a; let r; let i; const o=A(e); const s=Array.from(new Set(n.map(((e) =>e.Donor)))); const c=Array.from(new Set(n.map(((e) =>e.Year)))); const d=(a=Array.from(new Set(n.map(((e) =>e.Series)))),r=["Not reported","Other"],i=a.filter(((e) =>!r.includes(e))),r.forEach(((e) =>{a.includes(e)&&i.push(e)})),i); const f=window.echarts.init(e);J(f,H(n),{years:c,channels:d});let p=[];Object(l.createRoot)(o).render(u.a.createElement(h,{selectErrorMessage:"You can compare two donors. Please remove one before adding another."},u.a.createElement(S,{label:"Select up to two donors",options:s.map(((e) =>({value:e,label:e,isCloseable:!0}))),defaultValue:[{value:"All donors",label:"All donors",isCloseable:!0}],isMulti:!0,onChange(e){if(e.length){const t=n.filter(((t) =>e.find(((e) =>e.value===t.Donor))));p=e.map(((e) =>e.value)),function(e,t,n){const a=n.donors; const r=n.channels; const i=n.years; const o=H(t); const l=a.map(((e) =>r.map(((t,n) =>({name:t,data:q(o,i,e,t).map(((e) =>({value:e&&Number(e.value).toFixed(2),emphasis:{focus:"self"}}))),type:"bar",stack:e,tooltip:{trigger:"item",formatter(n){const a=`<strong>${o.find(((a) =>a.Series===t&&a.Donor===e&&`${a.Year}`===n.name)).value}%</strong>`;

return `${e}, ${n.name} <br />${t}: ${a}`}},label:{show:n===0&&a.length>1,position:"insideBottom",distance:15,align:"left",verticalAlign:"middle",rotate:90,formatter(){return`${e}`},fontSize:16},cursor:"auto"}))))).reduce(((e,t) =>e.concat(t)),[]);e.setOption({series:l},{replaceMerge:["series"]})}(f,t,{donors:p,channels:d,years:c})}else J(f,H(n),{years:c,channels:d})},css:{minWidth:"200px"},classNamePrefix:"channels-chart-select",isClearable:!1}))),t.hideLoading(),D(f,e)}))}))}}})}; const K=n(95); const Q=n.n(K); const X=n(144); const ee=function(e){const t=Object(c.useState)(e.donorRecipients); const n=t[0]; const a=t[1]; const i=Object(c.useState)(e.defaultBreakdown); const o=i[0]; const l=i[1]; const s=Object(c.useState)(e.defaultRecipient); const u=s[0]; const d=s[1];Object(c.useEffect)((() =>{a(o==="By donor"?e.donorRecipients:e.orgTypeRecipients),e.onSelectBreakdown&&e.onSelectBreakdown(o,u)}),[o]),Object(c.useEffect)((() =>{e.onSelectRecipient&&e.onSelectRecipient(u,o)}),[u]);

return Object(r.b)(h,null,Object(r.b)(S,{classNamePrefix:"recipient-chart-select",label:"Select recipient",options:n.sort().map(((e) =>({value:e,label:e}))),defaultValue:[{value:e.defaultRecipient,label:e.defaultRecipient}],onChange(t){d(t.value||e.defaultRecipient)},css:{minWidth:"150px"}}),Object(r.b)(S,{classNamePrefix:"recipient-chart-breakdown",label:"Choose breakdown",options:["By donor","By type of organisation receiving funding"].map(((e) =>({value:e,label:e}))),defaultValue:[{value:e.defaultBreakdown,label:e.defaultBreakdown}],onChange(t){l(t.value||e.defaultBreakdown)},css:{minWidth:"300px"}}))};ee.propTypes={donorRecipients:f.a.array,orgTypeRecipients:f.a.array,defaultRecipient:f.a.string,defaultBreakdown:f.a.string,onSelectBreakdown:f.a.func,onSelectRecipient:f.a.func},ee.defaultProps={defaultBreakdown:"By donor",defaultRecipient:"Afghanistan"};const te=ee; const ne=["#f49b21","#fccc8e","#f9b865","#e48a00","#a85d00","#7d4712"]; const ae=["#f49b21","#feedd4","#fccc8e","#f9b865","#e48a00","#a85d00","#7d4712"]; const re=new Intl.NumberFormat; const ie=function(e){return e.trim()?Number(e.replace(",","").replace(" ","").replace("%","").trim()).toFixed(2):null}; const oe=function(e,t){return void 0===t&&(t="Value"),e.map(((e) =>{const n={...e};

return n.value=ie(e[t]),n}))}; const le=function(e,t,n,a){const r=e.filter(((e) =>e.Recipient.trim()===n&&e.Series===a));

return t.map(((e) =>r.find(((t) =>t.Year===e))||null))}; const se=function(e,t,n){const a=e.filter(((e) =>e.Series===t));

return n.map(((e) =>{const t=a.find(((t) =>t.Year===e));

return{value:t&&ie(t.Value)||null,emphasis:{focus:"self"}}}))}; const ce=function(e,t){const n=["US","Germany","EU institutions","Japan","UK","All other donors"]; const a=e.filter(((e) =>e.Recipient.trim()===t));

return n.length>=5?n:Array.from(new Set(a.map(((e) =>e.Series)))).filter(((e) =>!n.includes(e))).slice(0,5).concat(n)}; const ue=function(e){void 0===e&&(e="far");

return{type:"value",nameRotate:90,name:"US$ millions",nameLocation:"end",nameTextStyle:{verticalAlign:"top",align:"right",padding:{near:[-35,0,0,0],middle:[-45,0,0,0],far:[-54,0,0,0]}[e]}}}; const de=function(e,t,n,a){const r=a.years; const i=a.channels; const l={color:ne,legend:{show:!0,top:"top",padding:[20,10,5,10],textStyle:{fontSize:"1.3rem"}},grid:{bottom:"10%",top:"20%"},xAxis:{type:"category",data:r,position:"bottom"},series:i.map(((e) =>({name:e,data:le(t,r,n,e).map(((e) =>({value:e&&Number(e.value).toFixed(2),emphasis:{focus:"self"}}))),type:"bar",stack:"channels",cursor:"auto",tooltip:{trigger:"item",formatter(t){return `${e}, ${t.name} <br />10 largest recipients: <strong>US$${re.format(Math.round(t.value))} million</strong>`}},animation:!1})))};

return l.yAxis=ue(L(l.series)),j.toolbox.feature.saveAsImage.name="recipients",e.setOption(o()(l,j),{replaceMerge:["series"]}),e.on("legendselectchanged",((t) =>{N(e,t)})),e}; const fe=function(e,t,n){const a=n.recipient; const r=n.years; const i=oe(t); const o=ce(t,a).map(((e) =>({name:e,data:le(i,r,a,e==="All other donors"?"Other donors":e).map(((e) =>({value:e&&Number(e.value).toFixed(2),emphasis:{focus:"self"}}))),type:"bar",stack:a,cursor:"auto",tooltip:{trigger:"item",formatter(t){return `${e}, ${t.name} <br/>${a}: <strong>US$${re.format(Math.round(t.value))} million</strong>`}}}))).reduce(((e,t) =>e.concat(t)),[]);e.setOption({yAxis:ue(L(o)),series:o},{replaceMerge:["series"]})}; const pe=function(e,t,n){const a=n.recipient; const r=n.years; const i=function(e){const t=["Not reported","Other"]; const n=e.filter(((e) =>!t.includes(e)));

return t.forEach(((t) =>{e.includes(t)&&n.push(t)})),n}(function(e,t){const n=e.filter(((e) =>e.Recipient.trim()===t));

return Array.from(new Set(n.map(((e) =>e.Series))))}(t,a)).map(((e) =>({name:e,data:se(t,e,r),type:"bar",stack:a,cursor:"auto",tooltip:{trigger:"item",formatter(t){return `${t.name} <br/>${e}: <strong>US$${re.format(Math.round(t.value))} million</strong>`}}}))).reduce(((e,t) =>e.concat(t)),[]); const o=ae;e.setOption({yAxis:ue(L(i)),color:o,series:i},{replaceMerge:["series"]})}; const me=function(){window.DICharts.handler.addChart({className:"dicharts--gha-recipients",echarts:{onAdd(e){Array.prototype.forEach.call(e,function(){const e=Object(X.a)(Q.a.mark((function e(t){let n; let a; let r; let i; let o; let s; let c; let d; let f; let p; let m; let b; let h;

return Q.a.wrap(((e) =>{for(;;)switch(e.prev=e.next){case 0:return n=new window.DICharts.Chart(t.parentElement),e.next=3,E("https://raw.githubusercontent.com/devinit/gha-data-visualisations/feature/climate-map/public/assets/data/recipient-and-donors.csv");case 3:a=e.sent,r=a.filter(((e) =>e.Type==="Donor")),i=a.filter(((e) =>e.Type==="Channel")),o=A(t),s=Array.from(new Set(r.map(((e) =>e.Recipient)))),c=Array.from(new Set(r.map(((e) =>e.Year)))),"Afghanistan","By donor",d=ce(r,"Afghanistan"),f=Array.from(new Set(i.map(((e) =>e.Recipient)))),p=window.echarts.init(t),de(p,oe(r),"Afghanistan",{years:c,channels:d}),m="Afghanistan",b=function(e,t){if(void 0===t&&(t="By donor"),m=e||"Afghanistan",t==="By donor")if(m!=="10 largest recipients"){const n=r.filter(((e) =>e.Recipient===m));fe(p,n,{recipient:m,years:c})}else m="10 largest recipients",de(p,oe(r),"10 largest recipients",{years:c,channels:d});else pe(p,i.filter(((t) =>t.Recipient===e)),{recipient:e,years:c})},h=function(e,t){if(e==="By donor")if(t!=="10 largest recipients"){const n=r.filter(((e) =>e.Recipient===t));fe(p,n,{recipient:t,years:c})}else de(p,oe(r),"10 largest recipients",{years:c,channels:d});else pe(p,i.filter(((e) =>e.Recipient===t)),{recipient:t,years:c})},Object(l.createRoot)(o).render(u.a.createElement(te,{donorRecipients:s,orgTypeRecipients:f,onSelectRecipient:b,onSelectBreakdown:h,defaultBreakdown:"By donor",defaultRecipient:"Afghanistan"})),n.hideLoading(),D(p,t);case 22:case"end":return e.stop()}}),e)})));

return function(t){return e.apply(this,arguments)}}())}}})}; const be=n(145); const he=n.n(be); const ge=function(e){const t=Object(c.useState)("People_in_need_(millions)"); const n=t[0]; const a=t[1]; const r=[{name:"People_in_need_(millions)",label:"People in need",icon:"https://devinit.org/assets/svg/icons/people-in-need-icon-yellow.svg",disabledIcon:"https://devinit.org/assets/svg/icons/people-in-need-icon-disabled.svg"},{name:"Crisis_type",label:"Crisis state",icon:"https://devinit.org/assets/svg/icons/crisis-type-icon-yellow.svg",disabledIcon:"https://devinit.org/assets/svg/icons/crisis-type-icon-disabled.svg"},{name:"IPC_Food_insecurity_phase",label:"Food insecurity",icon:"https://devinit.org/assets/svg/icons/food-security-yellow.svg",disabledIcon:"https://devinit.org/assets/svg/icons/food-security-disabled.svg"},{name:"Climate_vulnerability",label:"Climate vulnerability",icon:"https://devinit.org/assets/svg/icons/climate-vulnerability-icon-yellow.svg",disabledIcon:"https://devinit.org/assets/svg/icons/climate-vulnerability-icon-disabled.svg"}];

return Object(c.useEffect)((() =>{e.onSelectDimension(n),window.dataLayer.push({event:"mapFilterSelected",filter:r.find(((e) =>e.name===n)).label})}),[n]),u.a.createElement("ul",null,r.map(((e) =>u.a.createElement("li",{key:e.name,className:"mapFilterItem"},e.icon?u.a.createElement(u.a.Fragment,null,u.a.createElement("button",{onClick(){a(e.name)},className:n===e.name?"mapFilterButton mapFilterItem-active":"mapFilterButton"},u.a.createElement("img",{src:n===e.name?e.icon:e.disabledIcon,alt:e.name,height:"20",width:"20"}),u.a.createElement("p",{className:e.name==="Food_insecure_(millions)"?"food-icon":""},e.label))):u.a.createElement("button",{onClick(){a(e.name)}},u.a.createElement("p",null,e.label))))))};ge.propTypes={onSelectDimension:f.a.func};const ve=ge; const ye=function(e){return u.a.createElement("button",{className:"reset-button",onClick:e.onReset},"Reset")};ye.propTypes={onReset:f.a.func};const we=ye; const Se="https://devinit.org/assets/svg/icons/response-plan-icon-yellow.svg"; const Ce=["#fac47e","#f7a838","#df8000","#ba6b15","#7d4712"]; const _e=[{variable:"Crisis_type",data:[{score:"",label:"Not in crisis"},{score:"In Crisis",label:"In crisis"},{score:"Entering protracted crisis",label:"Entering protracted crisis"},{score:"In protracted crisis",label:"In protracted crisis"}]},{variable:"IPC_Food_insecurity_phase",data:[{score:"Not assessed",label:"No data"},{score:"2",label:"2"},{score:"3",label:"3"},{score:"3+",label:"3+"},{score:"4",label:"4"}]},{variable:"People_in_need_(millions)"},{variable:"Climate_vulnerability",data:[{score:"",label:"No data"},{score:"1",label:"Very low"},{score:"2",label:"Low"},{score:"3",label:"Medium"},{score:"4",label:"High"},{score:"5",label:"Very high"}]}]; const xe=function(e){return e.trim()}; const Ee=function(e,t,n){return e?`${n}% funded (US$${xe(t)} million of US$${xe(e)} million)`:"None"}; const Ae=function(e,t){return e.map(((e) =>({id:e.Country_ID,name:e.Country_name}))).find(((e) =>e.id===t)).name}; const Oe=function(e,t,n,a,r){const i=[];

return e.forEach(((e) =>{const o={};o.name=e,t.forEach(((t) =>{t[n]===e&&(o[t.variable]=t[a],r&&(o[r]=t[r]))})),i.push(o)})),i}; const Ne=function(e,t){return e.map(((e) =>{const n={...e}; const a=t.find(((t) =>t.name===e.properties.WB_NAME));

return a&&(n.properties={...e.properties,...a}),n}))}; const Te=function(e,t){if(t==="Crisis_type")switch(e){case"In protracted crisis":return"#7d4712";case"Entering protracted crisis":return"#ba6b15";case"In Crisis":return"#df8000";default:return"#E6E1E5"}else if(t==="IPC_Food_insecurity_phase")switch(e){case"4":return"#7d4712";case"3+":return"#ba6b15";case"3":return"#df8000";case"2":return"#f7a838";default:return"#E6E1E5"}else switch(e){case"5":return"#7d4712";case"4":return"#ba6b15";case"3":return"#df8000";case"2":return"#f7a838";case"1":return"#fac47e";default:return"#E6E1E5"}}; const De=window.L.control({position:"bottomright"});De.onAdd=function(){return this.div=window.L.DomUtil.create("div","databox"),this.div.setAttribute("data-id","databoxContainer"),this.update(),this.div},De.update=function(e,t){let n; let a; let r; let i;this.div.innerHTML=e?`<div style="padding-bottom: 0px;">${Ae(t,e.iso_a3)} <button id=closeDatabox><img src=https://devinit.org/assets/svg/icons/cross.colors-poppy-slate-blank-poppydark.svg alt=close height=20 width=20 ></img></button></div><div style="margin-top: 8px;"> ${(n=e,[{value:(a=n["Country_response_plan_requirements_(US$,_million)"],r=n["Country_response_plan_coverage_(%)"],i=n["Country_response_plan_funding_(US$,_million)"],a?`${r}% funded (US$${xe(i)} million  of US$${xe(a)} million)`:"None"),label:"Country RP",icon:{image:Se,text:"response-plan"}},{value:Ee(n["Regional_response_plan_requirements_(US$,_million)"],n["Regional_response_plan_funding_(US$,_million)"],n["Regional_response_plan_coverage_(%)"]),label:"Regional RP",icon:{image:Se,text:"response-plan"}}]).map(((e) =>`<span><img src=${e.icon.image} alt=${e.icon.text} height=20 width=20 ></img><p>${e.label}: ${e.value}</p> </span>`)).join("")}</div>`:"";const o=document.getElementById("closeDatabox");o&&o.addEventListener("click",((e) =>function(e,t){e.stopPropagation(),t.update(),document.querySelector('[data-id="databoxContainer"]').style.display="none"}(e,De)))};const Le=function(e,t,n,a,r,i){for(var o=[],l=t;l<=n;l+=a)o.push(l);

return r.scale(i).domain(o)(Math.abs(e))}; const je=function(e,t){const n=t.map(((t) =>Number(t[e])));

return{maxValue:Math.ceil(Math.max.apply(Math,n)),minValue:Math.ceil(Math.min.apply(Math,n))<10?0:Math.ceil(Math.min.apply(Math,n))}}; const Me=function(e){return e>=0&&e<40?"Very low":e>=40&&e<50?"Low":e>=50&&e<55?"Medium":e>=55&&e<60?"High":e>=60?"Very high":"Not assessed"}; const Ve=function(e){return e>=0&&e<1e-4?"#d3e0f4":e>=1e-4&&e<.001?"#a3c7eb":e>=.001&&e<.01?"#77adde":e>=.01&&e<.1?"#4397d3":e>=.1&&e<1?"#105fa3":e>=1?"#00538e":"#E6E1E5"}; const Re=function(e,t,n,a,r,i,o,l,s){let c; const u=o;u.onAdd=function(){const t=window.L.DomUtil.create("div","legend"); const n=je(e,r); const a=e==="People_in_need_(millions)"?`${Ce.map(((e) =>`<span>\n          <i style="background:${e};border-radius:1px;margin-right:0;width:40px;"></i>\n        </span>`)).join("")} <p style="margin-left:1px;margin-top: 4px;">${n.minValue} - ${n.maxValue}, millions of people</p>`:_e.find(((t) =>t.variable===e)).data.map(((t) =>`<span><i style="background:${Te(t.score,e)}"></i><label>${t.label}</label></span>`)).join("");

return t.innerHTML=a,t},u.addTo(t);let d; const f=function(t){return{fillColor:n(t.properties[e],e),weight:1,opacity:1,color:"white",fillOpacity:1}}; const p=function(e){c.resetStyle(e.target),e.target.closePopup()}; const m=function(n,a){n.properties[e]||n.properties[e]===""?a.on({mouseover(t){return function(e,t,n,a){const r=e.target; const i=document.querySelector('[data-id="databoxContainer"]');i&&i.style.display!=="none"&&(De.update(),i.style.display="none"),r.setStyle({fillColor:"#5da3d9",color:"#484848",weight:2}),window.L.Browser.ie||window.L.Browser.opera||window.L.Browser.edge||r.bringToFront(),r.bindTooltip(r.feature.properties[t]!=="No data"&&r.feature.properties[t]!=="Not assessed"?`<div>${Ae(a,r.feature.properties.iso_a3)}<br>${n.find(((e) =>e.name===t)).label}: ${t==="Food_insecure_(millions)"&&r.feature.properties[t]==="0.0"?"< 0.1":r.feature.properties[t]}<span style="padding-left: 2px;">${n.find(((e) =>e.name===t)).unit}</span></div>`:`<div>${Ae(a,r.feature.properties.iso_a3)}<br> Not assessed</div>`,{direction:"top",opacity:1}).openTooltip()}(t,e,i,s)},mouseout:p,click(e){return function(e,t,n,a){n.addTo(t);const r=e.target;window.dataLayer.push({event:"countryClicked",country:Ae(a,r.feature.properties.iso_a3)}),n.update(r.feature.properties,a)}(e,t,De,s)}}):a.on({mouseover(){t.getContainer().querySelectorAll(".leaflet-interactive").forEach(((e) =>{e.classList+=" grab-cursor-enabled"}))},mouseout(){t.getContainer().querySelectorAll(".leaflet-interactive.grab-cursor-enabled").forEach(((e) =>{e.classList.remove("grab-cursor-enabled")}))}})};l.clearLayers(),c=window.L.geoJSON((d=r,a.map(((e) =>{const t={...e}; const n=d.find(((t) =>t.name===e.properties.name));

return n&&(t.properties={...e.properties,...n}),t}))),{style:f,onEachFeature:m}),l.addLayer(c)};const Ue=function(){window.DICharts.handler.addChart({className:"dicharts--gha-people-affected-by-crisis-leaflet",echarts:{onAdd(e){Array.prototype.forEach.call(e,((e) =>{window.dataLayer=window.dataLayer||[];const t=new window.DICharts.Chart(e.parentElement); const n=window.L.map(e,{maxZoom:3,minZoom:1,crs:window.L.CRS.EPSG4326,center:[6.6,20.9],zoom:1,attributionControl:!1}); const a="People_in_need_(millions)"; const i=A(e); const o=[{name:"People_in_need_(millions)",label:"People in need",scaleType:"continous",unit:"million"},{name:"Crisis_type",label:"Crisis state",scaleType:"piecewise",unit:""},{name:"IPC_Food_insecurity_phase",label:"Food insecurity",scaleType:"piecewise",unit:""},{name:"Climate_vulnerability",label:"Climate vulnerability",scaleType:"piecewise",unit:""}]; const s=window.L.control({position:"topright"}); const c=window.L.control({position:"bottomleft"});t.showLoading(),window.fetch("https://raw.githubusercontent.com/devinit/gha-data-visualisations/feature/climate-map/src/data/world_map.geo.json").then(((e) =>e.json())).then(((e) =>{const u=e.features;E("https://raw.githubusercontent.com/devinit/gha-data-visualisations/feature/climate-map/src/data/map_data_long.csv").then(((e) =>{let d; let f; let p; const m=(d=u,f="Country_ID",p="Country_name",e.map(((e) =>{const t={...e}; const n=d.find(((e) =>e.properties.iso_a3===t[f]));

return n&&(t[p]=n.properties.name),t}))); const b=Array.from(new Set(m.map(((e) =>e.Country_name)))); const h=Oe(b,m,"Country_name","value"); const g=window.L.featureGroup().addTo(n); const v=function(e,t){const n=je(t,h); const a=(n.maxValue-n.minValue)/Ce.length;

return e?Le(e,n.minValue,n.maxValue,a,he.a,Ce):"#E6E1E5"}; const y=function(){n.setView([6.6,20.9],1)};Object(l.createRoot)(i).render(Object(r.b)(ve,{onSelectDimension(t){Re(t,n,o.find(((e) =>e.name===t)).scaleType==="continous"?v:Te,u,h,o,s,g,e)}})),c.onAdd=function(){const e=window.L.DomUtil.create("div");

return Object(l.createRoot)(e).render(Object(r.b)(we,{onReset:y})),e},c.addTo(n),Re(a,n,o.find(((e) =>e.name===a)).scaleType==="continous"?v:Te,u,h,o,s,g,e),t.hideLoading()}))})).catch(((e) =>console.log(e)))}))}}})}; const ke=(n(624),n(625),[{year:"2017",progress:0},{year:"2018",progress:25},{year:"2019",progress:50},{year:"2020",progress:75},{year:"2021",progress:100}]); const Ie=function(e){const t=Object(c.useState)(e.defaultValue?e.defaultValue:e.min); const n=t[0]; const a=t[1];Object(c.useEffect)((() =>{e.onChange&&e.onChange(n)}),[n]);

return u.a.createElement("div",{className:`range labelled-data-selector--wrapper ${e.className}`},u.a.createElement("label",null,u.a.createElement("b",null,e.label)),u.a.createElement("input",{type:"range",id:e.name,value:n,min:e.min,max:e.max,step:e.step,onChange(t){t.preventDefault();let n; const r=document.querySelector(`#${e.name}`);e.incremental&&(n=e.name==="years"?ke.find(((e) =>e.year===t.target.value)).progress:Number(t.target.value)/Number(r.max)*100,r.style.background=`linear-gradient(to right, #cb5730 ${n}%, #ccc ${n}%)`),a(t.target.value)}}),u.a.createElement("div",{className:"slider-ticks"},e.dataList.map(((e) =>u.a.createElement("span",{key:e}," ",u.a.createElement("label",null,e))))))};Ie.propTypes={step:f.a.number,min:f.a.string,max:f.a.string,onChange:f.a.func,label:f.a.string,dataList:f.a.array,name:f.a.string,incremental:f.a.bool,className:f.a.string,defaultValue:f.a.string};const Fe=Ie; const Pe=function(e){const t=e.label; const n=e.onChange; const a=Object(c.useState)(!0); const r=a[0]; const i=a[1]; const o=Object(c.useState)(""); const l=o[0]; const s=o[1];Object(c.useEffect)((() =>{s(r?"yes":"")}),[r]),Object(c.useEffect)((() =>{n&&n(l)}),[l]);

return u.a.createElement("div",{className:"radio-select labelled-data-selector--wrapper"},u.a.createElement("label",null,t),u.a.createElement("label",{htmlFor:"yes"},u.a.createElement("input",{type:"checkbox",name:"yes",id:"yes",onChange(e){e.target.name==="yes"&&i(!r)},checked:r})," Countries in protracted crisis"))};Pe.propTypes={onChange:f.a.func,label:f.a.string};const Be=Pe; const $e=["#bcd4f0","#77adde","#5da3d9","#0089cc","#0c457b"]; const Ge=["#d3e0f4","#a3c7eb","#77adde","#4397d3","#105fa3","#00538e"]; const ze=["0","0.1m","1m","10m","100m","1b","1.5b"]; const We=[{label:4,value:60,text:"Very high"},{label:3,value:55,text:"High",min:55,max:60},{label:2,value:50,text:"Medium",min:50,max:55},{label:1,value:40,text:"Low",min:40,max:50},{label:0,value:0,text:"Very low",min:0,max:40}]; const Ye=function(e,t){const n=t.filter(((t) =>t[e])).map(((t) =>Number(e==="Total_Climate_Share"||e==="CCA_Share"||e==="CCM_Share"?t[e].replace("%",""):t[e])));

return{maxValue:Math.ceil(Math.max.apply(Math,n)),minValue:Math.ceil(Math.min.apply(Math,n))<10?0:Math.ceil(Math.min.apply(Math,n))}}; const He=function(e,t,n){const a=Ye(t,n); const r=(a.maxValue-a.minValue)/$e.length;

return e?Le(t==="Total_Climate_Share"||t==="CCA_Share"||t==="CCM_Share"?e.replace("%",""):e,a.minValue,a.maxValue,r,he.a,$e):"#E6E1E5"}; const qe=function(e,t){if(t===0)return e;const n=We.find(((e) =>e.value===t));

return n.value===60?e.filter(((e) =>e.Vulnerability_Score_new>=60)):e.filter(((e) =>e.Vulnerability_Score_new<n.max&&e.Vulnerability_Score_new>=n.min))}; const Je=function(e,t){return e.filter(((e) =>e.year===t))}; const Ze=function(e,t){return e==="CCA"&&t==="Total_Climate_USD"?"CCA_USD":e==="CCA"&&t==="Total_Climate_Share"?"CCA_Share":e==="CCM"&&t==="Total_Climate_Share"?"CCM_Share":e==="CCM"&&t==="Total_Climate_USD"?"CCM_USD":t}; const Ke=function(e){return We.find(((t) =>t.label===e)).value}; const Qe=function(e,t,n){return n==="total"?e==="Total_Climate_Share"?t.properties[e]:t.properties[e]/1e3:e==="Total_Climate_Share"?t.properties[Ze(n,e)]:t.properties[Ze(n,e)]/1e3}; const Xe=function(e,t){return e.find(((e) =>e.name===t))}; const et=function(e,t,n,a){let r; const i=Xe(e,n);

return i?(r=a==="total"?t==="Total_Climate_Share"?i[t]:i[t]/1e3:t==="Total_Climate_Share"?i[Ze(a,t)]:i[Ze(a,t)]/1e3,t==="Total_Climate_Share"?He(r,a==="total"?t:Ze(a,t),e):Ve(r,a==="total"||Ze(a,t))):"#E6E1E5"}; const tt=[{name:"Solomon Islands",coordinates:[-10.575488,161.755118]},{name:"Vanuatu",coordinates:[-15.04767,166.737858]},{name:"Comoros",coordinates:[-11.638005,43.328645]},{name:"Cabo Verde",coordinates:[16.841028,-23.742468]},{name:"São Tomé and Príncipe",coordinates:[.384856,6.651183]},{name:"Mauritius",coordinates:[-21.008972,55.405847]},{name:"Fiji",coordinates:[-17.493468,178.018069]},{name:"Samoa",coordinates:[-13.494016,-172.520477]},{name:"Saint Vincent and the Grenadines",coordinates:[13.348472,-61.147504]},{name:"Tuvalu",coordinates:[-8.444944,179.127396]},{name:"Tonga",coordinates:[-21.141279,-175.303819]},{name:"Timor-Leste",coordinates:[-8.555272,126.67637]},{name:"Tokelau",coordinates:[-9.129344,-171.840652]},{name:"Seychelles",coordinates:[-4.596714,55.443287]},{name:"Palau",coordinates:[7.599856,134.62149]},{name:"Nauru",coordinates:[-.520427,166.936612]},{name:"Marshall Islands",coordinates:[7.583201,168.612489]},{name:"Maldives",coordinates:[-.383325,73.103751]},{name:"Kiribati",coordinates:[1.784491,-157.299146]},{name:"Antigua and Barbuda",coordinates:[17.195139,-61.306447]}]; const nt=function(e,t,n,a,r,i,o,l,s,c,u,d){let f; let p; const m=o;m.onAdd=function(){const t=window.L.DomUtil.create("div","legend"); const n=Ye(d==="total"?e:Ze(d,e),r); const a=function(e,t,n){for(var a=[],r=t/n,i=e;a.length<=n;)i===e&&a.push(i),i+=r,Number(i)===i&&i%1!=0?a.push(Number(i.toFixed(1))):a.push(i);

return a}(n.minValue,n.maxValue,$e.length); const i=`<div style="display:flex;flex-direction:column;">\n    <div>\n    ${e==="Total_Climate_Share"?$e.map(((e) =>`<span>\n      <i style="background:${e};border-radius:1px;margin-right:0;width:50px;"></i>\n    </span>`)).join(""):Ge.map(((e) =>`<span>\n          <i style="background:${e};border-radius:1px;margin-right:0;width:50px;"></i>\n        </span>`)).join("")}\n    </div>\n    <div>\n    ${e==="Total_Climate_Share"?a.map(((e,t) =>t===a.length-1?`<span> ${e} (%)</span>`:`<span style="width:50px;">${e}</span>`)).join(""):ze.map(((e,t) =>`\n        <span style="width:45px;">${t===ze.length-1?`${e} ($)`:e}</span>\n        `)).join("")}\n    </div>\n     </div>`;

return t.innerHTML=i,t},m.addTo(t);const b=function(t){return{fillColor:e==="Total_Climate_Share"?n(Qe(e,t,d),d==="total"?e:Ze(d,e),r):n(Qe(e,t,d),d==="total"?e:Ze(d,e)),weight:1,opacity:1,color:"white",fillOpacity:1}}; const h=function(a){let i;

return(i={})[a.properties.protracted_crisis&&a.properties[e]&&u?"fillPattern":"fillColor"]=function(a){return a.properties.protracted_crisis&&a.properties[e]&&u?new window.L.StripePattern({weight:2,spaceWeight:1,angle:45,color:"#d12568"}).addTo(t):e==="Total_Climate_Share"?n(Qe(e,a,d),d==="total"?e:Ze(d,e),r):n(Qe(e,a,d),d==="total"?e:Ze(d,e))}(a),i.weight=1,i.opacity=1,i.color="white",i.fillOpacity=1,i}; const g=function(e){f.resetStyle(e.target),p.resetStyle(e.target),e.target.closePopup()}; const v=function(n,a){n.properties[e]||n.properties[e]===""?a.on({mouseover(t){return function(e,t,n,a){const r=e.target;r.setStyle({fillColor:"#df8000",color:"#484848",weight:2}),window.L.Browser.ie||window.L.Browser.opera||window.L.Browser.edge||r.bringToFront();let i; let o; const l=(i=a,o=r.feature.properties.ISO_A3,i.find(((e) =>e.iso3===o))?i.find(((e) =>e.iso3===o)).countryname:"");r.bindTooltip(r.feature.properties[t]?`<div>${l||r.feature.properties.WB_NAME}<br>\n          Adaptation:  US$ ${Number(r.feature.properties.CCA_USD).toFixed(1)} ( ${Number(r.feature.properties.Total_Climate_USD)!==0?(Number(r.feature.properties.CCA_USD)/Number(r.feature.properties.Total_Climate_USD)*100).toFixed(1):0}%)<br>\n          Mitigation: US$ ${Number(r.feature.properties.CCM_USD).toFixed(1)} (${Number(r.feature.properties.Total_Climate_USD)!==0?(Number(r.feature.properties.CCM_USD)/Number(r.feature.properties.Total_Climate_USD)*100).toFixed(1):0}%)<br>\n          Climate vulnerability: ${r.feature.properties.Vulnerability_Score_new?Me(Number(r.feature.properties.Vulnerability_Score_new)):"Not assesed"}<br>\n          ${r.feature.properties.protracted_crisis?"In protracted crisis":""}\n          </div>\n          `:`<div>${l}<br> Not assessed</div>`,{direction:"top",opacity:1}).openTooltip()}(t,e,0,s)},mouseout:g}):a.on({mouseover(){t.getContainer().querySelectorAll(".leaflet-interactive").forEach(((e) =>{e.classList+=" grab-cursor-enabled"}))},mouseout(){t.getContainer().querySelectorAll(".leaflet-interactive.grab-cursor-enabled").forEach(((e) =>{e.classList.remove("grab-cursor-enabled")}))}})};tt.forEach(((n) =>{const a=Xe(r,n.name); const i=window.L.divIcon({className:"my-div-icon",html:`<div style='background-color:${et(r,e,n.name,d)};' class='marker-pin'></div>`}); const o=window.L.marker(n.coordinates,{icon:i});a&&(o.bindTooltip(a[e]?`<div>${n.name}<br>\n    Adaptation:  US$ ${Number(a.CCA_USD).toFixed(1)} ( ${Number(a.Total_Climate_USD)!==0?(Number(a.CCA_USD)/Number(a.Total_Climate_USD)*100).toFixed(1):0}%)<br>\n    Mitigation: US$ ${Number(a.CCM_USD).toFixed(1)} (${Number(a.Total_Climate_USD)!==0?(Number(a.CCM_USD)/Number(a.Total_Climate_USD)*100).toFixed(1):0}%)<br>\n    Climate vulnerability: ${a.Vulnerability_Score_new?Me(Number(a.Vulnerability_Score_new)):"Not assesed"}<br>\n    ${a.protracted_crisis?"In protracted crisis":""}\n    </div>\n    `:`<div>${n.name}<br> Not assessed</div>`,{direction:"top",opacity:1}),o.on("mouseover",((e) =>{e.target.openTooltip(),e.target._icon.childNodes[0].style.backgroundColor="#df8000"})),o.on("mouseout",((t) =>{t.target.closePopup(),t.target._icon.childNodes[0].style.backgroundColor=et(r,e,n.name,d)}))),o.addTo(t)})),l.clearLayers(),f=window.L.geoJSON(Ne(a,r),{style:b,onEachFeature:v}),p=window.L.geoJSON(Ne(a,r),{style:h,onEachFeature:v}),l.addLayer(f),u&&l.addLayer(p)};const at=function(){window.DICharts.handler.addChart({className:"dicharts--gha-climate-funding",echarts:{onAdd(e){Array.prototype.forEach.call(e,((e) =>{window.dataLayer=window.dataLayer||[];const t=new window.DICharts.Chart(e.parentElement); const n=window.L.map(e,{maxZoom:3,minZoom:1,crs:window.L.CRS.EPSG4326,center:[6.6,20.9],zoom:1,attributionControl:!1}); let a="Total_Climate_USD"; let i="2021"; let o=0; let s="total"; const c=A(e); const u=[{value:"Total_Climate_USD",label:"US$ millions"},{value:"Total_Climate_Share",label:"% of total ODA"}]; const d=[{value:"total",label:"Total climate finance"},{value:"CCA",label:"Climate adaptation finace"},{value:"CCM",label:"Climate mitigation finance"}]; const f=window.L.control({position:"topright"}); const p=window.L.control({position:"bottomleft"});t.showLoading(),window.fetch("https://raw.githubusercontent.com/devinit/gha-data-visualisations/feature/climate-map/public/assets/data/world_map.geo.json").then(((e) =>e.json())).then(((e) =>{const m=e.features;E("https://raw.githubusercontent.com/devinit/gha-data-visualisations/feature/climate-map/public/assets/data/climate_funding_data_long_format.csv").then(((e) =>{let b; let h; let g; let v; const y=(b=m,h="iso3",g="countryname",e.map(((e) =>{const t={...e}; const n=b.find(((e) =>e.properties.ISO_A3===t[h]));

return n&&(t[g]=n.properties.WB_NAME),t}))); let w=y.filter(((e) =>e.year===i)); const C=Array.from(new Set(y.map(((e) =>e.countryname)))); let _=Oe(C,w,"countryname","value_precise","protracted_crisis"); let x=qe(_,Ke(o)); const E=window.L.featureGroup().addTo(n);nt(a,n,a==="Total_Climate_Share"?He:Ve,m,x,0,f,E,e,0,v,s);const A=function(){n.setView([6.6,20.9],1)};Object(l.createRoot)(c).render(Object(r.b)("div",null,Object(r.b)(S,{classNamePrefix:"climate-chart-select",label:"Select value type",options:u,defaultValue:[{value:"Total_Climate_USD",label:"US$ millions"}],onChange(t){a=t.value?t.value:a,nt(a,n,a==="Total_Climate_Share"?He:Ve,m,x,0,f,E,e,0,v,s)},css:{minWidth:"150px"}}),Object(r.b)(S,{classNamePrefix:"climate-adaptation-select",label:"Select adaptation/mitigation",options:d,defaultValue:[{value:"total",label:"Total climate finance"}],onChange(t){s=t.value?t.value:s,nt(a,n,a==="Total_Climate_Share"?He:Ve,m,x,0,f,E,e,0,v,s)},css:{minWidth:"150px"}}),Object(r.b)(Fe,{label:"Select a year",min:"2017",max:"2021",defaultValue:"2021",step:1,onChange(t){w=Je(y,i=t||i),_=Oe(C,w,"countryname","value_precise","protracted_crisis"),x=qe(_,Ke(o)),nt(a,n,a==="Total_Climate_Share"?He:Ve,m,x,0,f,E,e,0,v,s)},dataList:["2017","2018","2019","2020","2021"],name:"years",incremental:!1}),Object(r.b)(Fe,{label:"Select vulnerability level",min:"0",max:"4",step:1,onChange(t){o=t?Number(t):o,x=qe(_,Ke(o)),nt(a,n,a==="Total_Climate_Share"?He:Ve,m,x,0,f,E,e,0,v,s)},dataList:["All countries","Low","Medium","High","Very high"],name:"vulnerability",incremental:!1,className:"range-width vulnerability-range"}),Object(r.b)(Be,{name:"crisis",label:"Highlight",onChange(t){v=t;const r=function(e,t){return t?e.filter(((e) =>e.protracted_crisis===t)):e}(Je(y,i),t);Array.from(new Set(r.map(((e) =>e.countryname)))),nt(a,n,a==="Total_Climate_Share"?He:Ve,m,x,0,f,E,e,0,v,s)}}))),p.onAdd=function(){const e=window.L.DomUtil.create("div");

return Object(l.createRoot)(e).render(Object(r.b)(we,{onReset:A})),e},p.addTo(n),t.hideLoading()}))})).catch(((e) =>console.log(e)))}))}}})}; const rt=function(e){return e.filter(((e) =>e["GNR Region"]!=="#N/A")).map(((e) =>[Number(e.Vulnerability),e["GNR Region"],Number(e["Total Climate Funding"]),e.Country]))}; const it=function(e,t){const n={tooltip:{trigger:"item",formatter(e){return `${e.data[3]} <br/>\n      Vulnerability: ${Me(100*Number(e.data[0]))} <br/>\n      Total climate finance: $${Number(e.data[2]).toFixed(1)} million\n      `}},grid:{bottom:"10%",top:"20%",left:"5%"},xAxis:{name:"Vulnerability level (Low to Very high)",nameLocation:"center",min:.4,max:.7,scale:!0,nameGap:25,axisLabel:{show:!1}},yAxis:{type:"category",data:["Oceania","Latin America and the Caribbean","Asia","Africa"],axisLabel:{formatter(e){return e==="Latin America and the Caribbean"?"LAC":e}}},series:[{type:"scatter",name:"Developing Countries",data:rt(t.filter(((e) =>e.PC!=="PC"))),itemStyle:{opacity:.8,borderColor:"black",color:"#facbad"},symbolSize(e){return Math.round(e[2])!==0?5*Math.log(Math.round(e[2])):e[2]},emphasis:{itemStyle:{borderColor:"#333",borderWidth:2.5}}},{type:"scatter",name:"Protracted Crisis",data:rt(t.filter(((e) =>e.PC==="PC"))),itemStyle:{opacity:.8,borderColor:"black",color:"#cb5730"},symbolSize(e){return Math.round(e[2])!==0?5*Math.log(Math.round(e[2])):e[2]},emphasis:{itemStyle:{borderColor:"#333",borderWidth:2.5}}}]};

return e.setOption(o()(j,n)),e.on("legendselectchanged",((t) =>{N(e,t)})),e}; const ot=function(){window.DICharts.handler.addChart({className:"dicharts--gha-total-climate-finance",echarts:{onAdd(e){Array.prototype.forEach.call(e,function(){const e=Object(X.a)(Q.a.mark((function e(t){let n; let a; let r;

return Q.a.wrap(((e) =>{for(;;)switch(e.prev=e.next){case 0:return n=new window.DICharts.Chart(t.parentElement),e.next=3,E("https://raw.githubusercontent.com/devinit/gha-data-visualisations/feature/climate-map/public/assets/data/Climate_Finance_Dataset.csv");case 3:a=e.sent,r=window.echarts.init(t),it(r,a),n.hideLoading(),D(r,t);case 8:case"end":return e.stop()}}),e)})));

return function(t){return e.apply(this,arguments)}}())}}})};window.addEventListener("load",(() =>{z(),Z(),me(),Ue(),at(),ot()}))}},[[253,1,2]]]);
